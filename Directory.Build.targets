<Project>
  <!-- 全局覆盖：Debug 构建强制使用 Musa.* 的 Release 运行时与库，避免调试 CRT 进入 DPC -->
  <PropertyGroup Condition="'$(Configuration)'=='Debug'">
    <!-- Release 库路径（存在则覆盖） -->
    <MusaRuntimeReleaseLib>$(MSBuildThisFileDirectory)external\Musa.Runtime\Publish\Library\Release\$(Platform)</MusaRuntimeReleaseLib>
    <MusaCoreReleaseLib>$(USERPROFILE)\.nuget\packages\musa.core\0.4.1\build\native\Library\Release\$(Platform)</MusaCoreReleaseLib>
    <MusaCoreLiteReleaseLib>$(USERPROFILE)\.nuget\packages\musa.corelite\1.0.3\build\native\Library\Release\$(Platform)</MusaCoreLiteReleaseLib>

    <!-- 覆盖库属性，确保下游 LibraryPath 只指向 Release 版本 -->
    <Musa_Runtime_Library>$(MusaRuntimeReleaseLib)</Musa_Runtime_Library>
    <Musa_Core_Library>$(MusaCoreReleaseLib)</Musa_Core_Library>
    <Musa_CoreLite_Library>$(MusaCoreLiteReleaseLib)</Musa_CoreLite_Library>

    <!-- 使用 Release 库路径，同时追加 WDK/VS 环境 LIB，避免引入 Debug 目录 -->
    <LibraryPath>$(MusaRuntimeReleaseLib);$(MusaCoreReleaseLib);$(MusaCoreLiteReleaseLib);$(LIB)</LibraryPath>
  </PropertyGroup>
</Project>
